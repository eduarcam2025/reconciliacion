<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Examen de Conciencia</title>
  <style>
  body {
  font-family: Arial, sans-serif;
  background: url('imgs/adultoopc1a.jpg') no-repeat center center fixed;

  padding: 20px;
}

.container {
  max-width: 500px;
  margin: auto;
  background: white;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

#question-container {
  font-size: 1.1em;
  margin-bottom: 20px;
}

button {
  padding: 10px 20px;
  font-size: 1em;
  cursor: pointer;
  border: none;
  border-radius: 5px;
  background-color: #007bff;
  color: white;
}

button:disabled {
  background-color: #ccc;
}
.explicacion-box {
  background-color: #f8f9fa;
  border-left: 4px solid #007bff;
  padding: 10px 15px;
  margin-top: 15px;
  font-size: 0.9em;
  color: #555;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.bloque{display:block}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>
  <div class="container">
    <h1>Examen de Conciencia</h1>
    <div id="question-container"></div>
    <button id="next-btn">Siguiente</button>
    <p id="progress"></p>
  </div>
      <footer style="
  margin-top: 30px;
  font-size: 0.75em;
  color: #666;
  text-align: center;
  padding: 15px;
  border-top: 1px solid #eee;
  line-height: 1.5;
  background-color: #f9f9f9;
  border-radius: 0 0 10px 10px;">
  <span class="bloque">© 2025 Soluciones Integrales SICC.</span> 
  <span class="bloque">Todos los derechos reservados.</span>
  <span class="bloque">Esta aplicación, su código fuente, diseño,</span>
  <span class="bloque">contenido, textos, interfaces y funcionalidades</span>
  <span class="bloque">son propiedad exclusiva de Soluciones Integrales SICC.</span>
  <span class="bloque">Queda prohibida su reproducción, distribución, modificación,</span>
  <span class="bloque">uso comercial, transferencia o explotación, total o parcial,</span>
  <span class="bloque">sin autorización escrita expresa.</span>
  
  <a href='sicc.solution@gmail.com' style='color: #007bff; text-decoration: underline;'>Solicite licencia aquí</a>
</footer>

  <script>
  // ⚠️ Reemplaza con tu URL de API de NocoDB
const API_URL = 'https://app.nocodb.com/api/v2/tables/ma9gj7dnxydrbd3/records';
const AUTH_TOKEN = 'bVeUflboREE5qKo-3C2ynKlfmxcFaRxDhS2h2Uh1';



const preguntas = [
  { 
    texto: "¿He rezado mis oraciones?", 
    valor: "Positivo",
    explicacion: "Rezar significa hablar con Dios. Puedes rezar por las mañanas, antes de dormir o cuando sientas que necesitas ayuda."
  },
  { 
    texto: "¿He ido a Misa los Domingos?", 
    valor: "Positivo",
    explicacion: "Ir a Misa es un momento especial para estar con Dios y con la comunidad cristiana. Los domingos es obligatorio ir si puedes."
  },
  { 
    texto: "¿He tomado el nombre de Dios en vano?", 
    valor: "Negativo",
    explicacion: "Tomo el nombre de Dios en vano cuando: Estoy en la misa con pereza, distraído o de mal humor. Cuando me burlo de los compañeros llamados a participar activamente en la misa (leer, cantar, hacer la colecta, portar ofrendas) Cuando hago juramentos o promesas en el nombre de Dios sabiendo en mi corazón que es falso lo que prometo."
  },
  { 
    texto: "¿Me he distraído voluntariamente en Misa o en la Iglesia?", 
    valor: "Negativo",
    explicacion: "Durante la Misa debemos estar atentos y rezar. Pensar en otras cosas o hacer ruido entristece a Dios y distrae a los demás."
  },
  { 
    texto: "¿He ayudado en casa?", 
    valor: "Positivo",
    explicacion: "Ayudar en casa con tareas pequeñas muestra amor a tu familia y responsabilidad."
  },
  { 
    texto: "¿He sido egoísta o he tratado a mis padres y hermanos con poco cariño?", 
    valor: "Negativo",
    explicacion: "El egoísmo es pensar solo en uno mismo. Debemos tratar a nuestra familia con amor, paciencia y respeto, conversando con serenidad sobre lo que nos molesta."
  },
  { 
    texto: "¿He obedecido a mis padres y profesores?", 
    valor: "Positivo",
    explicacion: "Obedecer a quienes nos cuidan es parte de amarlos y respetarlos. Dios nos pide que honremos a nuestros padres."
  },
  { 
    texto: "¿He compartido mis juguetes?", 
    valor: "Positivo",
    explicacion: "Cuando comparto, demuestro que no soy egoísta, sin embargo, también tengo derecho a pedir a los demás que traten mis cosas con igual generosidad y respeto."
  },
  { 
    texto: "¿He sido impaciente?", 
    valor: "Negativo",
    explicacion: "Sentir enojo es una emoción humana, pero si grito, pateo o insulto, puedo lastimarme o lastimar a quienes me rodean. Debemos hablar sobre lo que nos molesta sin perder la calma."
  },
  { 
    texto: "¿Me he enfadado?", 
    valor: "Negativo",
    explicacion: "Sentir enojo está bien, pero si grito, pateo o insulto, ya no está bien. Debemos controlarnos."
  },
  { 
    texto: "¿He sido caprichoso o pesado para que las cosas se hicieran como yo quiero?", 
    valor: "Negativo",
    explicacion: "Hay momentos en los que debo comportarme de forma respetuosa, seguir instrucciones y reglas, cuando me llamen la atención ante mis faltas o no me den lo que quiero no debo reaccionar con berrinches o malas palabras."
  },
  {  
    texto: "¿Pierdo el tiempo en clase?", 
    valor: "Negativo",
    explicacion: "Mi responsabilidad es pedir ayuda cuando no comprendo y valorar el tiempo que invierto en estudiar, además es mi deber atender a las orientaciones de mis maestros y no alterar la convivencia en el aula."
  },
  { 
    texto: "¿He hecho mis deberes lo mejor que puedo?", 
    valor: "Positivo",
    explicacion: "Hacer bien los deberes es un acto de responsabilidad y respeto a mis profesores, padres y a mi mismo, además que de esa forma me apropio de lo visto en el aula."
  },
  { 
    texto: "¿He copiado en los exámenes?", 
    valor: "Negativo",
    explicacion: "Copiar o ayudar a otros a que se copien amenaza al conocimiento. Es deshonesto y ofende a Dios, que nos ve siempre."
  },
  { 
    texto: "¿Me he peleado?", 
    valor: "Negativo",
    explicacion: "Las peleas vienen del enojo y pueden hacer daño. Mejor resolver los problemas hablando con calma."
  },
  { 
    texto: "¿He hecho daño a alguna persona hablando mal de ella?", 
    valor: "Negativo",
    explicacion: "Hablar mal de otros (chismes, insultos) es pecado. Daña su reputación y su corazón."
  },
  { 
    texto: "¿He dicho mentiras?", 
    valor: "Negativo",
    explicacion: "Mentir es ocultar la verdad. Dios es la Verdad, por eso no debemos mentir, aunque sea 'una pequeña mentira'."
  },
  { 
    texto: "¿He robado algo?", 
    valor: "Negativo",
    explicacion: "Robar es tomar lo que no es mío. Aunque sea un caramelo o un lápiz, es pecado."
  },
  { 
    texto: "¿He estropeado alguna cosa que no era mía a propósito?", 
    valor: "Negativo",
    explicacion: "Dañar cosas ajenas es falta de respeto. Si no es mío, debo cuidarlo como si lo fuera."
  },
  { 
    texto: "¿He dado buen ejemplo?", 
    valor: "Positivo",
    explicacion: "Cuando actúo bien, otros me imitan. Puedo ayudar a que otros se acerquen a Dios con mi ejemplo."
  },
  { 
    texto: "¿He animado a otros a que hicieran cosas malas?", 
    valor: "Negativo",
    explicacion: "Es necesario que busque orientación si en mi corazón siento que está bien juntarme con otros para romper las normas, burlarme de otras personas, o ser indiferentes cuando alguien necesite ayuda."
  },
  { 
    texto: "¿He sido egoísta de pensamiento o de obra?", 
    valor: "Negativo",
    explicacion: "El egoísmo puede ser un sintoma de envidia, y la envidia ante los meritos y poseciones de otros, son contrarias a Dios."
  },
  { 
    texto: "¿He tenido celos de otros?", 
    valor: "Negativo",
    explicacion: "Los celos son enojarse porque otro tiene algo bueno. Debemos alegrarnos por los demás."
  },
  { 
    texto: "¿He excluido a alguien de mis juegos?", 
    valor: "Negativo",
    explicacion: "Jesús nos enseña a incluir a todos."
  },
  { 
    texto: "¿He rezado por los demás y les he ayudado para que estén más cerca de Dios?", 
    valor: "Positivo",
    explicacion: "Rezar por otros es amarlos. Ayudarles a ser mejores es cooperar con la obra de Dios."
  }
];


let currentQuestionIndex = 0;
let registrosPecados = []; // Aquí guardamos las respuestas con puntuación 1

const questionContainer = document.getElementById("question-container");
const nextBtn = document.getElementById("next-btn");
const progress = document.getElementById("progress");

function showQuestion() {
  const pregunta = preguntas[currentQuestionIndex];
  questionContainer.innerHTML = `
    <p><strong>${pregunta.texto}</strong></p>
    <label><input type="radio" name="respuesta" value="Sí"> Sí</label><br>
    <label><input type="radio" name="respuesta" value="No"> No</label>
    <div class="explicacion-box">
      <strong>Reflexión:</strong> ${pregunta.explicacion}
    </div>
  `;
  updateProgress();
}


function updateProgress() {
  progress.textContent = `Pregunta ${currentQuestionIndex + 1} de ${preguntas.length}`;
}

async function saveAnswer(preguntaTexto, valor, respuesta, puntuacion) {
  const preguntaFormateada = `${respuesta} ${preguntaTexto.replace(/[¿?]/g, '')}`.trim();

  const data = {
    Pregunta: preguntaFormateada,
    valor,
    respuesta,
    puntuacion,
    respuesta2: preguntaFormateada
  };

  try {
    const response = await fetch(API_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'xc-token': AUTH_TOKEN
      },
      body: JSON.stringify(data)
    });

    if (!response.ok) {
      const errorText = await response.text();
      console.error('Error al guardar:', errorText);
      alert(`Error guardando: ${errorText}`);
    }

    // Si la puntuación es 1, lo añadimos a la lista de pecados
    if (puntuacion === 1) {
      registrosPecados.push(preguntaFormateada);
    }

  } catch (error) {
    console.error('Error de red:', error);
    alert('Hubo un problema conectándose al servidor.');
  }
}

nextBtn.addEventListener("click", async () => {
  const selected = document.querySelector('input[name="respuesta"]:checked');
  if (!selected) return alert("Por favor, selecciona una opción.");

  const respuesta = selected.value;
  const preguntaObj = preguntas[currentQuestionIndex];
  const valor = preguntaObj.valor;

  // Calcular puntuación
  let puntuacion = 0;
  if ((valor === "Positivo" && respuesta === "No") || (valor === "Negativo" && respuesta === "Sí")) {
    puntuacion = 1;
  }

  // Guardar en NocoDB
  await saveAnswer(preguntaObj.texto, valor, respuesta, puntuacion);

  currentQuestionIndex++;
  if (currentQuestionIndex < preguntas.length) {
    showQuestion();
  } else {
    // Mostrar resultados finales
    mostrarResumenFinal();
  }
});

function mostrarResumenFinal() {
  questionContainer.innerHTML = `
    <h2>Estos son los pecados que debo llevar al Sacerdote</h2>
    <ul>
      ${registrosPecados.map(pecado => `<li>${pecado}</li>`).join("")}
    </ul>
    <button id="download-pdf-btn">Descargar como PDF</button>
    <button onclick="window.location.href='oracion.html'" style="margin-left: 10px;">Inicio</button>
  `;

  nextBtn.style.display = "none";

  // Botón de descarga de PDF
  document.getElementById("download-pdf-btn").addEventListener("click", () => {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    doc.setFontSize(16);
    doc.text("Estos son los pecados que debo llevar al Sacerdote", 10, 20);

    registrosPecados.forEach((linea, index) => {
      doc.setFontSize(12);
      doc.text(`• ${linea}`, 15, 35 + (index * 10));
    });

    doc.save("pecados.pdf");
  });
}

showQuestion();

  </script>
</body>
</html>
